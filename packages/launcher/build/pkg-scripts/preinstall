#!/bin/sh
#This is a sample preinstall or postinstall script.
#Your logic goes here.
echo "Trying to run the npm scripts" >> /tmp/mf_preinstall.log
export PATH=$PATH:/usr/local/bin
echo $PATH >> /tmp/mf_preinstall.log
install () {
    set x
    /usr/local/lib/node_modules/npm/bin/npm-cli.js install --global @mainframe/daemon >/tmp/mf_preinstall.log 2>&1
    if [[ $? -eq 0 ]]; then
        return 0
    else
        return 1
    fi
}

main () {
    set x
    mainframed -h || { echo 'daemon not found' ; install; }
}

main
